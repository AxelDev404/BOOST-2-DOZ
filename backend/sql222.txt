/*PRIMO ESERCIZIO INNER JOIN */


SELECT nome , cognome , nome_classe FROM Studenti INNER JOIN Classi ON Classi.id_classe = Studenti.id_classe;

SELECT COUNT(id_studente) AS totale_alunni , nome_classe FROM Studenti 
INNER JOIN Classi ON Classi.id_classe = Studenti.id_classe GROUP BY nome_classe HAVING totale_alunni > 0;

SELECT COUNT(id_studente) AS totale_alunni, nome_classe FROM Studenti 
INNER JOIN Classi ON Classi.id_classe = Studenti.id_studenti GROUP BY nome_classe HAVING totale_alunni > 1;

SELECT nome , cognome , nome_classe FROM Studenti 
INNER JOIN Clssi ON Classi.id_classe = Studenti.id_classe WHERE nome_classe = "3A";

SELECT nome , cognome , nome_classe , anno FROM Studenti INNER JOIN Classi ON Classi.id_classe = Studenti.id_classe;


/*SECONDO ESERCIZIO INNER JOIN */


SELECT titolo , nome_autore FROM Autori INNER JOIN Libri ON Libri.id_autore = Autori.id_autore;

SELECT COUNT(id_autore) AS libri_scritti , nome_autore FROM Autori INNER JOIN Libri ON Libri.id_autore = Autori.id_autore GROUP BY nome_autore ORDER BY libri_scritti  DESC;

SELECT titolo , nome_autore FROM Autori 
INNER JOIN Libri ON Libri.id_autore = Autori.id_autore WHERE nome_autore = 'Italo Calvino';


/*TERZO ESERCIZIO INNER JOIN LEFT E RIGHT JOIN*/


SELECT nome_cliente , data_ordine , nome_prodotto FROM Clienti INNER JOIN Ordini ON Ordini.id_cliente = Clienti.id_cliente 
INNER JOIN Prodotti ON Prodotti.id_ordine = Ordini.id_ordine;

SELECT nome_cliente , id_ordine FROM Clienti LEFT JOIN Ordini ON Ordini.id_cliente = Clienti.id_cliente;

SELECT nome_cliente , id_ordine FROM Clienti RIGHT JOIN Ordini ON Ordini.id_cliente = Clienti.id_cliente;

SELECT nome_cliente,id_cliente, COUNT(id_ordine) AS ordini_fatti FROM Clienti LEFT JOIN Ordini ON Ordini.id_cliente = Clienti.id_cliente GROUP BY nome_cliente HAVING ordini_fatti = 0; 


/*ESERCIZI SCUOLA SQL*/


SELECT nome_categoria,  descrizione , COUNT(id_prodotto) AS numero_prodotti FROM Categorie
INNER JOIN Prodotti ON Prodotti.id_categoria = Categorie.id_categoria ORDER BY nome_categoria;

SELECT  nome_scieta, id_prodotto , AVG(prezzo_unitario) AS prezzo_medio FROM Fornitori 
INNER JOIN Prodotti ON Prodotti.id_fornitore = Fornitore.id_fornitore;

SELECT nome_prodotto , MAX(qta_per_unita) AS qta_massima , MIN(qta_per_unita) AS qta_minima FROM Prodotti GROUP BY nome_prodotto;

SELECT Superire.cognome , COUNT(id_impiegato) AS sup FROM Impiegati 
INNER JOIN Impiegati AS Superiori ON Impiegati.sup = Superiore.id_impiegato GROUP BY sup.nome , sup.cognome;

SELECT posizione , MAX(data_nascita) AS data_massima , MIN(data_nascita) AS data_minima FROM Impiegati GROUP BY posizione; 

SELECT nome , cognome, COUNT(id_ordine) AS ordini_inseriti FROM Impiegati 
INNER JOIN Ordini ON Ordini.id_impiegato = Impiegati.id_impiegato GROUP BY nome , cognome;

SELECT id_fornitore , nome_societa , COUNT(id_prodotto) AS prodotti_forniti FROM Fornitori 
INNER JOIN Prodotti ON Prodotti.id_fornitore = Fornitore.id_fornitore GROUP BY id_fornitore , nome_societa;

SELECT citta_fornitore.citta , COUNT(id_fornitore) AS prodotti_forniti FROM Fornitori 
INNER JOIN Fornitori AS citta_fornitore ON citta_fornitore.id_fornitore = Fornitori.id_fornitore GROUP BY citta_fornitore.citta;

SELECT nome_societa , AVG(prezzo_unitario) AS prezzo_medio FROM Fornitori
INNER JOIN Prodotti ON Prodotti.id_prodotto = Fornitori.id_fornitore GROUP BY nome_societa;

SELECT nome_categoria , COUNT(id_prodotto) AS totale_prodotti FROM Categorie 
INNER JOIN Prodotti ON Prodotti.id_categoria = Categorie.id_categoria GROUP BY nome_categoria;
 
SELECT nome_categoria, nome_prodotto , MAX(prezzo_unitario) AS prezzo_massimo , MIN(prezzo_unitario) AS prezzo_minimo FROM Catrogie
INNER JOIN Prodotti ON Prodotti.id_categoria = Categorie.id_categoria GROUP BY nome_categoria;

SELECT Cliente.nome_societa , COUNT(id_ordine) AS ordini_fatti FROM Clienti 
INNER JOIN Ordini ON Ordini.id_cliente = Clienti.id_clienti GROUP BY Cliente.nome_societa;

SELECT Corrieri.nome_societa , MAX(data_ordine) AS data_maggiore , MIN(data_ordine) AS data_minima FROM Corrieri 
INNER JOIN Ordini ON Ordini.id_corriere = Corrieri.id_corriere GROUP BY Corrieri.nome_societap;

/*ESERCIZI SCUOLA JOIN ESTERNI*/


SELECT nome_prodotto , id_ordine , data_ordine FROM Prodotti
INNER JOIN DettaglioOrdini ON DettaglioOrdini.id_prodotto = Prodotti.id_prodotto
INNER JOIN Ordni ON Ordini.id_ordine = DettaglioOrdine.id_ordine 
LEFT JOIN Prodotti ON Prodotti.id_prodotto = DettaglioOrdini.id_prodotto WHERE scorte > 20;


SELECT Impiegato.nome , Impiegato.cognome , Superiore.cognome FROM Impiegato 
INNER JOIN Impiegato AS Superiore ON Superiore.id_superiore = Impiegato.id_superiore
LEFT JOIN Impiegato ON Impiegato.id_impiegato = Superiore.id_impiegato WHERE data_nascita > '01/01/1960';


SELECT nome , cognome , id_impiegato , id_ordine FROM Impiegato 
LEFT JOIN Ordini ON Ordini.id_impiegato = Impiegato.id_impiegato WHERE data_ordine > "31/12/1994";


SELECT id_fornitore , nome_societa , nome_prodotto FROM Fornitori
INNER JOIN Prodotti ON Prodotti.id_fornitore = Fornitore.id_prodotto 
INNER JOIN Categorie ON Categorie.id_categoria = Prodotti.id_categoria 
LEFT JOIN Fornitori ON Fornitori.id_prodotto = Prodotti.id_prodotto WHERE nome_categoria = 'dolciumi';



SELECT nome_categoria , id_prodotto , nome_prodotto , prezzo_unitario FROM Categorie 
LEFT JOIN Prodotti ON Prodotti.id_categoria = Categoria.id_categoria WHERE prezzo_unitario > 100000;


SELECT id_corriere , data_ordini , citta_destinatario FROM Corrieri 
LEFT JOIN Ordini ON Ordini.id_corriere = Corrieri.id_corriere WHERE citta_destinatario = 'Madrid';

SELECT nome_societa , citta , cap , zona , paese , id_ordine , data_ordini FROM Clienti
LEFT JOIN Ordini ON Ordini.id_cliente = Clienti.id_clienti WHERE data_ordini BETWEEN '01/01/1996' AND '31/12/1996';

















